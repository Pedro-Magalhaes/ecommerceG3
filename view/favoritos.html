<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Favoritos</title>
    <link rel="stylesheet" href= "styles/estilo.css">
    <script src="../model/funcoes.js" defer></script>
</head>
<body>
    
    <div id="topbar">
        <a href="index.html">  <img id="logo" class="logo" src="IMG/logo.png" alt="ML"><img></a>
        <div id="icones-pequenos">
            <a href="login.html"> <img id="perfil" class="icon" src="IMG/perfil.png" alt="perfil"/> </a>
            <a href="favoritos.html"> <img id="favorite" class="icon" src="IMG/favorites.png" alt="favorite"/>  </a>
            <a href="carrinho.html"> <img id="cart" class="icon" src="IMG/carrinho.png" alt="cart"/></a>
        </div>
    </div>

       <br/><br/>
   
        
 <div id="fav-container">
  <h1 class="fav">Lista de Favoritos</h1>
  <div id="listaFavoritos"></div>
  <button id="removerTodosFav">Remover Tudo</button>
</div>

      

  <div id="listaFavoritos"></div>

<script>
  function renderFavoritos() {
    const div = document.getElementById('listaFavoritos');
    const favoritos = JSON.parse(localStorage.getItem('favoritos')) || [];

    if (favoritos.length === 0) {
      div.innerHTML = `
  <div class="msg-vazio">
    <p>Oops... parece que sua lista de favoritos está vazia!</p>
    <a href="index.html" class="btn-voltar">Ver produtos</a>
  </div>
`;
   const btnRF= document.getElementById('removerTodosFav');
    if(btnRF) btnRF.style.display='none';
      return;
    }

    // cada item vem com um botão Remover
    div.innerHTML = favoritos.map((item, i) => `
      <div class="item-favoritos">
        <img class="img-favoritos" src="${item.imagem}" width="100" alt="${item.nome}">
        <p>${item.nome} - R$ ${item.preco}</p>
        <button class="btn-remover" data-index="${i}" aria-label="Remover ${item.nome}">
          Remover
        </button>
      </div>
    `).join('');
  }

  // chama ao carregar a página
  window.addEventListener('load', renderFavoritos);
</script>

<script>
  // clique em qualquer botão .btn-remover dentro do documento
  document.addEventListener('click', (e) => {
    const btn = e.target.closest('.btn-remover');
    if (!btn) return;

    const idx = Number(btn.dataset.index);
    const favoritos = JSON.parse(localStorage.getItem('favoritos')) || [];

    // remove 1 item na posição idx
    favoritos.splice(idx, 1);
    localStorage.setItem('favoritos', JSON.stringify(favoritos));

    // re-renderiza a lista
    renderFavoritos();
  });
</script>
        <script>
    document.getElementById("removerTodosFav").onclick = () => {
     
    
    // esvazia o carrinho
    localStorage.removeItem("favoritos");
    
    // renderiza novamente a tela do carrinho
    renderFavoritos();
  };      
    </script>
    <footer id="rodape">
        <h2 class="texto-rodape">MoveLar - Móveis e acessórios para todos os ambientes. Conforto, praticidade e estilo para sua casa e escritório.</h2>
        <a href="sobreNos.html" class="texto-rodape">Sobre nós</a>
    </footer>
</body>
</html>